import{r as h,a1 as re,t as w,M as L,E as M,J as se,j as e,ab as O,bp as ae,b6 as le,a2 as P}from"./index-DiiwzJ83.js";import{I as ne}from"./info-Clro60_y.js";const $=({className:o,...s})=>e.jsx("input",{className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-purple-500 focus:border-transparent ${o}`,...s}),E=({className:o,rows:s=3,...x})=>e.jsx("textarea",{rows:s,className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none ${o}`,...x}),B=({variant:o="default",className:s="",children:x,disabled:b,...k})=>{const N="px-4 py-2 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",S={default:"bg-purple-600 hover:bg-purple-700 text-white disabled:hover:bg-purple-600",outline:"border border-gray-300 dark:border-gray-600 bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 disabled:hover:bg-transparent",ghost:"bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 disabled:hover:bg-transparent"};return e.jsx("button",{className:`${N} ${S[o]} ${s}`,disabled:b,...k,children:x})},u=({children:o,className:s=""})=>e.jsx("label",{className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 ${s}`,children:o}),ie=({children:o,variant:s="default",className:x=""})=>{const b={default:"bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200",secondary:"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200"};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${b[s]} ${x}`,children:o})},oe=[{emoji:"ðŸ˜­",label:"Terrified",color:"bg-red-100 dark:bg-red-900 border-red-300 dark:border-red-700"},{emoji:"ðŸ˜”",label:"Sad",color:"bg-blue-100 dark:bg-blue-900 border-blue-300 dark:border-blue-700"},{emoji:"ðŸ˜",label:"Neutral",color:"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-600"},{emoji:"ðŸ˜Š",label:"Happy",color:"bg-green-100 dark:bg-green-900 border-green-300 dark:border-green-700"},{emoji:"ðŸ¤©",label:"Euphoric",color:"bg-yellow-100 dark:bg-yellow-900 border-yellow-300 dark:border-yellow-700"}],p=[{id:1,title:"Dream Basics",subtitle:"Tell us about your dream",icon:L,fields:["title","description","date"]},{id:2,title:"Emotions",subtitle:"How did it make you feel?",icon:M,fields:["mood","intensity"]},{id:3,title:"Dream Elements",subtitle:"What appeared in your dream? (Optional)",icon:se,fields:["symbols","themes","characters","setting"]},{id:4,title:"Additional Context",subtitle:"Help us understand better (Optional)",icon:ne,fields:["notes_to_ai","real_life_link"]}];function ue({onClose:o}){const[s,x]=h.useState(1),[b,k]=h.useState(!1),[N,S]=h.useState(!1),[W,q]=h.useState(new Set),[d,_]=h.useState({}),[j,I]=h.useState({}),V=new Date().toISOString().split("T")[0],Y=re();h.useEffect(()=>{w("dream_create_started"),setTimeout(()=>S(!0),10)},[]);const F=()=>{S(!1),setTimeout(()=>{w("dream_create_abandoned"),o()},300)},[a,J]=h.useState({title:"",description:"",date:V,mood:"Neutral",intensity:50,symbols:[],themes:[],characters:[],setting:[],notes_to_ai:"",real_life_link:""}),y=p.find(t=>t.id===s),D=(t,r)=>{switch(w("Validation Failed",{source:"Dream Form",field:t}),t){case"title":return!r||r.trim().length===0?"Title is required":r.trim().length<3?"Title must be at least 3 characters":null;case"description":return!r||r.trim().length===0?"Description is required":r.trim().length<10?"Description must be at least 10 characters":null;case"date":return r?null:"Date is required";case"mood":return r?null:"Please select a mood";case"intensity":return r==null?"Please set intensity level":null;default:return null}},c=(t,r)=>{J(n=>({...n,[t]:r})),d[t]&&_(n=>({...n,[t]:null}))},v=t=>{I(n=>({...n,[t]:!0}));const r=D(t,a[t]);_(n=>({...n,[t]:r}))},K=()=>{if(s<=2){const t=y.fields;for(const r of t)if(D(r,a[r]))return!1;return!0}return!0},z=()=>{if(s<=2){const t=y.fields,r={},n={};return t.forEach(i=>{const m=D(i,a[i]);r[i]=m,n[i]=!0}),_(i=>({...i,...r})),I(i=>({...i,...n})),Object.values(r).every(i=>!i)}return!0},R=()=>{z()&&(q(r=>new Set([...r,s])),s<p.length&&x(s+1))},X=()=>{s>1&&x(s-1)},G=async()=>{var r,n,i,m;if(z()){k(!0);try{const f={...a,symbols:((r=a.symbols)==null?void 0:r.filter(Boolean))||[],themes:((n=a.themes)==null?void 0:n.filter(Boolean))||[],characters:((i=a.characters)==null?void 0:i.filter(Boolean))||[],setting:((m=a.setting)==null?void 0:m.filter(Boolean))||[]};await Y.post("/dream",f),w("dream_create_completed"),P.success("Dream saved successfully! ðŸŽ‰",{description:"You can view your dream in My Dreams section."}),F()}catch(f){console.error("Error saving dream:",f),P.error("Failed to save dream. Please try again.")}finally{k(!1)}}},C=({value:t=[],onChange:r,placeholder:n,suggestions:i=[]})=>{const[m,f]=h.useState(""),[Z,T]=h.useState(!1),A=l=>{const g=l.trim();g&&!t.includes(g)&&(r([...t,g]),f(""),T(!1))},ee=l=>{r(t.filter(g=>g!==l))},te=l=>{(l.key==="Enter"||l.key===",")&&(l.preventDefault(),A(m))},H=i.filter(l=>l.toLowerCase().includes(m.toLowerCase())&&!t.includes(l));return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{value:m,onChange:l=>{f(l.target.value),T(l.target.value.length>0)},onKeyDown:te,placeholder:n,onFocus:()=>T(m.length>0),onBlur:()=>setTimeout(()=>T(!1),200)}),Z&&H.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:H.map((l,g)=>e.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",onClick:()=>A(l),children:l},g))})]}),t.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map((l,g)=>e.jsxs(ie,{className:"flex items-center gap-1",children:[l,e.jsx("button",{type:"button",onClick:()=>ee(l),className:"ml-1 hover:bg-purple-200 dark:hover:bg-purple-800 rounded-full p-0.5",children:e.jsx(O,{size:12})})]},g))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Type and press Enter or comma to add. You can add your own or select from suggestions."})]})},Q=()=>{switch(s){case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(u,{children:"What would you call this dream? *"}),e.jsx($,{value:a.title,onChange:t=>c("title",t.target.value),onBlur:()=>v("title"),placeholder:"e.g., The Flying Adventure, The Mysterious Forest..."}),j.title&&d.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.title})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Describe your dream in detail *"}),e.jsx(E,{value:a.description,onChange:t=>c("description",t.target.value),onBlur:()=>v("description"),placeholder:"Write everything you remember - the more detail, the better we can help you understand it...",rows:4}),j.description&&d.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.description})]}),e.jsxs("div",{children:[e.jsx(u,{children:"When did you have this dream? *"}),e.jsx($,{type:"date",value:a.date,onChange:t=>c("date",t.target.value),onBlur:()=>v("date"),max:V}),j.date&&d.date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.date})]})]});case 2:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(u,{children:"How did this dream make you feel? *"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mt-3",children:oe.map(t=>e.jsxs("button",{type:"button",onClick:()=>{c("mood",t.label),v("mood")},className:`p-4 rounded-xl border-2 transition-all duration-200 ${a.mood===t.label?`${t.color} border-purple-500 ring-2 ring-purple-200 dark:ring-purple-800`:`${t.color} border-transparent hover:border-gray-300 dark:hover:border-gray-600`}`,children:[e.jsx("div",{className:"text-3xl mb-2",children:t.emoji}),e.jsx("div",{className:"text-sm font-medium",children:t.label})]},t.label))}),j.mood&&d.mood&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.mood})]}),e.jsxs("div",{children:[e.jsx(u,{children:"How intense was this feeling? *"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:a.intensity,onChange:t=>{c("intensity",parseInt(t.target.value)),v("intensity")},className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #7c3aed 0%, #7c3aed ${a.intensity}%, #e5e7eb ${a.intensity}%, #e5e7eb 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx("span",{children:"Barely noticeable"}),e.jsxs("span",{className:"font-medium text-purple-600 dark:text-purple-400",children:[a.intensity,"%"]}),e.jsx("span",{children:"Overwhelming"})]})]})}),j.intensity&&d.intensity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.intensity})]})]});case 3:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center text-gray-600 dark:text-gray-400 mb-6",children:[e.jsx("p",{children:"These fields are optional but help us provide better insights."}),e.jsx("p",{className:"text-sm",children:"You can type your own or select from suggestions."})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Symbols that appeared"}),e.jsx(C,{value:a.symbols,onChange:t=>c("symbols",t),placeholder:"e.g., water, fire, animals, keys...",suggestions:["water","fire","animals","keys","doors","mirrors","stairs","money","car","house"]})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Themes or topics"}),e.jsx(C,{value:a.themes,onChange:t=>c("themes",t),placeholder:"e.g., adventure, fear, love, success...",suggestions:["adventure","fear","love","success","failure","death","rebirth","journey","conflict","reunion"]})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Characters who appeared"}),e.jsx(C,{value:a.characters,onChange:t=>c("characters",t),placeholder:"e.g., family member, stranger, celebrity...",suggestions:["family member","friend","stranger","celebrity","deceased person","childhood friend","coworker","teacher"]})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Setting or location"}),e.jsx(C,{value:a.setting,onChange:t=>c("setting",t),placeholder:"e.g., childhood home, school, unknown place...",suggestions:["childhood home","school","workplace","unknown place","nature","city","ocean","mountains","space"]})]})]});case 4:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-center text-gray-600 dark:text-gray-400 mb-6",children:e.jsx("p",{children:"These optional details can help provide more personalized insights."})}),e.jsxs("div",{children:[e.jsx(u,{children:"Notes for AI analysis"}),e.jsx(E,{value:a.notes_to_ai,onChange:t=>c("notes_to_ai",t.target.value),placeholder:"Any additional context, emotions, or thoughts you want the AI to consider while analyzing your dream...",rows:3}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:'e.g., "I was stressed about work before sleeping" or "This dream felt very vivid"'})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Connection to real life"}),e.jsx(E,{value:a.real_life_link,onChange:t=>c("real_life_link",t.target.value),placeholder:"Did anything from your day or recent experiences trigger this dream?",rows:3}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:'e.g., "Had a job interview yesterday" or "Watched a scary movie"'})]})]});default:return null}},U=!K();return e.jsx("div",{className:`fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 transition-opacity duration-300 ${N?"opacity-100":"opacity-0"}`,children:e.jsxs("div",{className:`bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transition-all duration-300 ${N?"opacity-100 scale-100":"opacity-0 scale-95"}`,children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(L,{className:"w-6 h-6"}),"Dream Journal"]}),e.jsxs("p",{className:"text-purple-100 mt-1",children:["Step ",s," of ",p.length]})]}),e.jsx("button",{onClick:()=>{w("dream_create_abandoned"),F()},className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-purple-100",children:y.title}),e.jsxs("span",{className:"text-sm text-purple-100",children:[Math.round(s/p.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:e.jsx("div",{className:"bg-white h-2 rounded-full transition-all duration-300",style:{width:`${s/p.length*100}%`}})})]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center",children:e.jsx(y.icon,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:y.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.subtitle})]})]}),e.jsx("div",{className:"flex gap-1",children:p.map(t=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-all duration-200 ${t.id===s?"bg-purple-600 dark:bg-purple-400":t.id<s||W.has(t.id)?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`},t.id))})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-96",children:e.jsx("div",{children:Q()},s)}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(B,{type:"button",variant:"outline",onClick:X,disabled:s===1,className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Previous"]}),s===p.length?e.jsx(B,{type:"button",onClick:G,disabled:b,className:"flex items-center gap-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4"}),"Save Dream"]})}):e.jsxs(B,{type:"button",onClick:R,className:"flex items-center gap-2",disabled:U,children:["Next",e.jsx(le,{className:"w-4 h-4"})]})]})})]})})}export{ue as default};
