import{y,r as h,j as e,z as v,C as D,a as M,a8 as ie,a9 as oe,aa as ce,B as u,ab as z,ac as _,$ as S,W as ee,X as ae,Y as se,Z as te,a2 as i,M as de,T as me,D as E,U as I,E as he,I as re,a3 as xe,a4 as ge,ad as pe,ae as fe,af as je,ag as ue,ah as T,ai as $,J as H,a1 as le,aj as ye,ak as V,al as B,am as O,an as U,ao as q,ap as Y,aq as Z,ar as G,as as J,_ as we,at as ve,u as Ne,t as R}from"./index-DslgdRtL.js";import{B as k}from"./badge-DbXobgV4.js";import{T as be}from"./textarea-93_9_elS.js";import{C as ke}from"./circle-check-big-DZVm0XZu.js";import{M as ne}from"./mail-K_zEHV3x.js";import{F as W,C as Ce}from"./flame-B4_B5jog.js";import{S as X}from"./separator-D8cAh4oZ.js";import{M as Pe,T as A}from"./trash-2-BJNP8_Sh.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],De=y("Bookmark",Se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Le=y("Camera",Me);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],K=y("Globe",Ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],_e=y("Lock",Fe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],F=y("LogOut",Ee);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Te=y("Monitor",Ie);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],$e=y("PenLine",ze);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ve=y("Save",He);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Oe=y("Settings",Be);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],qe=y("Smartphone",Ue);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Ze=y("Target",Ye);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]],Q=y("Trophy",Ge);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Re=y("User",Je),We=({user:a,onUpdateProfile:f,isUpdating:r})=>{const[x,o]=h.useState(!1),[t,g]=h.useState({username:(a==null?void 0:a.username)||"",bio:(a==null?void 0:a.bio)||"",profileImage:(a==null?void 0:a.profileImage)||""}),[n,c]=h.useState(!1);h.useEffect(()=>{g({username:(a==null?void 0:a.username)||"",bio:(a==null?void 0:a.bio)||"",profileImage:(a==null?void 0:a.profileImage)||""}),c(!1)},[a]);const j=l=>{g(d=>({...d,[l.target.name]:l.target.value})),c(!0)},N=l=>{const d=l.target.files[0];if(d){if(d.size>2*1024*1024){i.error("Image size should be less than 2MB");return}const C=new FileReader;C.onload=()=>{g(s=>({...s,profileImage:C.result})),c(!0)},C.readAsDataURL(d)}},b=()=>{g(l=>({...l,profileImage:""})),c(!0)},p=async()=>{if(!n){i.info("No changes to save");return}try{const l=new FormData;if(t.username.trim()!==a.username&&l.append("username",t.username.trim()),t.bio.trim()!==(a.bio||"")&&l.append("bio",t.bio.trim()),t.profileImage&&t.profileImage.startsWith("data:image")){const d=await fetch(t.profileImage).then(C=>C.blob());l.append("profileImage",d,"profile.jpg")}else t.profileImage===""&&a.profileImage&&l.append("profileImage","");if([...l.entries()].length===0){i.info("No changes to save");return}await f(l),o(!1),c(!1)}catch{}},w=()=>{g({username:(a==null?void 0:a.username)||"",bio:(a==null?void 0:a.bio)||"",profileImage:(a==null?void 0:a.profileImage)||""}),o(!1),c(!1)};return e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs(D,{className:"relative overflow-hidden bg-gradient-to-br from-purple-50 to-blue-50 border-0 shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-100/50 to-blue-100/50"}),e.jsx(M,{className:"relative p-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(ie,{className:"w-24 h-24 border-4 border-white shadow-lg",children:[e.jsx(oe,{src:t.profileImage,alt:t.username}),e.jsx(ce,{className:"text-2xl bg-gradient-to-br from-purple-400 to-blue-400 text-white",children:t.username?t.username.split(" ").map(l=>l[0]).join("").toUpperCase():"?"})]}),x&&e.jsxs("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 flex gap-2",children:[e.jsxs("label",{className:"bg-white rounded-full p-2 shadow-lg cursor-pointer hover:bg-gray-50 transition-colors border",children:[e.jsx(Le,{className:"w-4 h-4 text-gray-600"}),e.jsx("input",{type:"file",accept:"image/*",onChange:N,className:"hidden",disabled:r})]}),t.profileImage&&e.jsx(u,{size:"sm",variant:"destructive",className:"rounded-full p-2 h-8 w-8 shadow-lg",onClick:b,disabled:r,children:e.jsx(z,{className:"w-3 h-3"})})]})]}),e.jsx("div",{className:"text-center space-y-4 w-full max-w-md",children:x?e.jsxs("div",{className:"space-y-4",children:[e.jsx(_,{name:"username",value:t.username,onChange:j,className:"text-center text-xl font-bold dark:text-black",placeholder:"Username",disabled:r}),e.jsx(be,{name:"bio",value:t.bio,onChange:j,placeholder:"Tell us about yourself...",className:"text-center resize-none dark:text-black",rows:2,disabled:r}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(u,{onClick:p,disabled:r||!n,size:"sm",className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600",children:[r?e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(Ve,{className:"w-4 h-4 mr-2"}),r?"Saving...":"Save"]}),e.jsxs(u,{onClick:w,variant:"outline",size:"sm",disabled:r,children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:a==null?void 0:a.username}),e.jsxs(k,{variant:"secondary",className:"capitalize",children:[a==null?void 0:a.provider," login"]}),(a==null?void 0:a.isVerified)&&e.jsx(ee,{children:e.jsxs(ae,{children:[e.jsx(se,{children:e.jsx(v.div,{animate:{scale:[1,1.2,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:e.jsx(ke,{className:"w-6 h-6 text-green-500"})})}),e.jsx(te,{children:e.jsx("p",{children:"Verified Account"})})]})})]}),e.jsxs("p",{className:"text-gray-600 flex items-center justify-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),a==null?void 0:a.email]}),(a==null?void 0:a.bio)&&e.jsx("p",{className:"text-gray-700 mx-auto leading-relaxed",children:a.bio}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center items-center pt-2",children:e.jsxs(u,{onClick:()=>o(!0),variant:"ghost",size:"sm",className:"hover:bg-white/50 dark:bg-black",disabled:r,children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})})]})})]})})]})})},Xe=({user:a,currentStreak:f})=>{var t,g;const r=[{title:"Dreams Created",value:(a==null?void 0:a.dreamCount)||0,icon:de,color:"from-purple-400 to-purple-600",tooltip:"Total dreams you've logged"},{title:"Current Streak",value:f||0,icon:W,color:"from-orange-400 to-red-500",tooltip:"Days in a row you've logged dreams",isStreak:!0},{title:"Best Streak",value:(a==null?void 0:a.maxDreamStreak)||0,icon:Q,color:"from-yellow-400 to-orange-500",tooltip:"Your longest dream logging streak",isMaxStreak:!0},{title:"Posts Liked",value:((t=a==null?void 0:a.likedPosts)==null?void 0:t.length)||0,icon:me,color:"from-pink-400 to-red-500",tooltip:"Community posts you've liked"},{title:"Bookmarks",value:((g=a==null?void 0:a.bookmarks)==null?void 0:g.length)||0,icon:De,color:"from-blue-400 to-blue-600",tooltip:"Posts you've bookmarked"}],x=a!=null&&a.createdAt?new Date(a.createdAt).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"Unknown",o=n=>n.isStreak&&f>0?e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-800",children:n.value}),f>=7&&e.jsx(v.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:"ðŸ”¥"})]}):n.isMaxStreak&&(a==null?void 0:a.maxDreamStreak)>0?e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-800",children:n.value}),a.maxDreamStreak>=30&&e.jsx(v.div,{animate:{rotate:[0,360]},transition:{duration:3,repeat:1/0},children:"ðŸ‘‘"})]}):e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:n.value});return e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:e.jsxs(D,{children:[e.jsx(E,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"Your Dream Journey Stats"]})}),e.jsxs(M,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-4",children:r.map((n,c)=>e.jsx(ee,{children:e.jsxs(ae,{children:[e.jsx(se,{asChild:!0,children:e.jsx(v.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(D,{className:"text-center hover:shadow-md transition-shadow cursor-pointer relative overflow-hidden",children:e.jsxs(M,{className:"p-4",children:[e.jsx("div",{className:`inline-flex p-3 rounded-full bg-gradient-to-r ${n.color} mb-2 shadow-lg`,children:e.jsx(n.icon,{className:"w-6 h-6 text-white"})}),e.jsx(v.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1*c,type:"spring"},children:o(n)}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:n.title}),n.isStreak&&f>0&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"})}),n.isMaxStreak&&(a==null?void 0:a.maxDreamStreak)>=10&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"})})]})})})}),e.jsx(te,{children:e.jsx("p",{children:n.tooltip})})]})},n.title))}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center mb-4",children:[f>=7&&e.jsxs(k,{variant:"secondary",className:"bg-orange-100 text-orange-800",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),"On Fire! ðŸ”¥"]}),(a==null?void 0:a.maxDreamStreak)>=30&&e.jsxs(k,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(Q,{className:"w-3 h-3 mr-1"}),"Dream Master ðŸ‘‘"]}),(a==null?void 0:a.dreamCount)>=100&&e.jsxs(k,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:[e.jsx(Ze,{className:"w-3 h-3 mr-1"}),"Century Club ðŸ’¯"]})]}),e.jsx("div",{className:"text-center",children:e.jsxs(k,{variant:"outline",className:"text-sm",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Member since ",x]})})]})]})})},Ke=({onChangePassword:a,isUpdating:f})=>{const[r,x]=h.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[o,t]=h.useState(!1),[g,n]=h.useState(!1),[c,j]=h.useState(!1),N=async()=>{if(r.newPassword!==r.confirmPassword){i.error("New passwords do not match");return}if(r.newPassword.length<8){i.error("Password must be at least 8 characters");return}if(r.newPassword.length>16){i.error("Password can be at most 16 characters");return}if(!/[A-Z]/.test(r.newPassword)){i.error("Must include at least one uppercase letter");return}if(!/[a-z]/.test(r.newPassword)){i.error("Must include at least one lowercase letter");return}if(!/\d/.test(r.newPassword)){i.error("Must include at least one number");return}if(!/[^A-Za-z0-9]/.test(r.newPassword)){i.error("Must include at least one special character");return}if(!r.currentPassword.trim()){i.error("Current password is required");return}try{await a({currentPassword:r.currentPassword,newPassword:r.newPassword}),x({currentPassword:"",newPassword:"",confirmPassword:""}),n(!1),j(!1),t(!1)}catch{}},b=()=>{x({currentPassword:"",newPassword:"",confirmPassword:""}),n(!1),j(!1)};return e.jsxs(xe,{open:o,onOpenChange:p=>{t(p),p||b()},children:[e.jsx(ge,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:"w-full",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Change Password"]})}),e.jsxs(pe,{className:"sm:max-w-md",children:[e.jsxs(fe,{children:[e.jsx(je,{children:"Change Password"}),e.jsx(ue,{children:"Enter your current password and choose a new secure password."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"currentPassword",children:"Current Password"}),e.jsx(_,{id:"currentPassword",type:"password",placeholder:"Enter your current password",value:r.currentPassword,onChange:p=>x(w=>({...w,currentPassword:p.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{id:"newPassword",type:g?"text":"password",placeholder:"Enter your new password",value:r.newPassword,onChange:p=>x(w=>({...w,newPassword:p.target.value})),className:"pr-10"}),e.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>n(!g),children:g?e.jsx($,{className:"h-4 w-4 text-gray-500"}):e.jsx(H,{className:"h-4 w-4 text-gray-500"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"8-16 characters with uppercase, lowercase, number & special character"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{id:"confirmPassword",type:c?"text":"password",placeholder:"Confirm your new password",value:r.confirmPassword,onChange:p=>x(w=>({...w,confirmPassword:p.target.value})),className:"pr-10"}),e.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>j(!c),children:c?e.jsx($,{className:"h-4 w-4 text-gray-500"}):e.jsx(H,{className:"h-4 w-4 text-gray-500"})})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[e.jsx(u,{variant:"outline",onClick:()=>t(!1),disabled:f,children:"Cancel"}),e.jsx(u,{onClick:N,disabled:f,children:f?"Updating...":"Update Password"})]})]})]})]})};function Qe({user:a,onLogout:f,onChangePassword:r,isUpdating:x}){const[o,t]=h.useState([]),[g,n]=h.useState(!0),[c,j]=h.useState(!1),[N,b]=h.useState(null),p=le();h.useEffect(()=>{(async()=>{try{const m=await p.get("/auth/sessions");t(m.data.sessions),i.success("Sessions loaded",{description:`Found ${m.data.sessions.length} active session(s)`})}catch(m){console.error("Failed to fetch sessions",m),i.error("Failed to load sessions",{description:"Unable to retrieve your active sessions. Please try again."})}finally{n(!1)}})()},[]);const w=async s=>{b(s);try{await p.delete(`/auth/sessions/${s}`),t(m=>m.filter(L=>L.id!==s)),i.success("Session terminated",{description:"Successfully logged out from the selected device"})}catch(m){console.error("Failed to logout session",m),i.error("Logout failed",{description:"Unable to terminate the session. Please try again."})}finally{b(null)}},l=async()=>{j(!0);try{await p.delete("/auth/sessions");const s=o.filter(m=>!m.isCurrent).length;t(m=>m.filter(L=>L.isCurrent)),i.success("All sessions terminated",{description:`Successfully logged out from ${s} other device(s)`})}catch(s){console.error("Failed to logout all",s),i.error("Logout failed",{description:s.message||"Unable to terminate all sessions. Please try again."})}finally{j(!1)}},d=s=>{const m=(s==null?void 0:s.toLowerCase())||"";return m.includes("mobile")||m.includes("android")||m.includes("iphone")?e.jsx(qe,{className:"w-4 h-4"}):e.jsx(Te,{className:"w-4 h-4"})},C=s=>{const m=new Date(s),P=Math.floor((new Date-m)/(1e3*60));return P<1?"Just now":P<60?`${P}m ago`:P<1440?`${Math.floor(P/60)}h ago`:`${Math.floor(P/1440)}d ago`};return e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[e.jsxs(D,{className:"border-2",children:[e.jsx(E,{className:"pb-4",children:e.jsxs(I,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Re,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold",children:"Profile Information"}),e.jsx("div",{className:"text-sm text-muted-foreground font-normal",children:"Manage your account details"})]})]})}),e.jsx(M,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[e.jsx(ne,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"Email"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a==null?void 0:a.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[e.jsx(ye,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"Provider"}),e.jsx(k,{variant:"outline",className:"text-xs",children:(a==null?void 0:a.provider)==="local"?"Email & Password":a==null?void 0:a.provider})]})]})]})})]}),e.jsxs(D,{className:"border-2",children:[e.jsx(E,{className:"pb-4",children:e.jsxs(I,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/20 rounded-lg",children:e.jsx(Oe,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold",children:"Security Settings"}),e.jsx("div",{className:"text-sm text-muted-foreground font-normal",children:"Manage your password and security preferences"})]})]})}),e.jsxs(M,{className:"space-y-4",children:[(a==null?void 0:a.provider)==="local"&&e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx(Ke,{onChangePassword:r,isUpdating:x})}),e.jsx(X,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-red-600 dark:text-red-400 flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"Logout Options"]}),e.jsxs(V,{children:[e.jsx(B,{asChild:!0,children:e.jsxs(u,{variant:"destructive",className:"w-full",disabled:x,children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Logout from this device"]})}),e.jsxs(O,{children:[e.jsxs(U,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-red-500"}),"Confirm Logout"]}),e.jsx(Y,{children:"This will remove your account session from this device. You'll need to log in again to access your account."})]}),e.jsxs(Z,{children:[e.jsx(G,{children:"Cancel"}),e.jsx(J,{onClick:f,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}),"Logging Out..."]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Logout"]})})]})]})]})]})]})]}),e.jsxs(D,{className:"border-2",children:[e.jsx(E,{className:"pb-4",children:e.jsxs(I,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:e.jsx(K,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold",children:"Active Sessions"}),e.jsx("div",{className:"text-sm text-muted-foreground font-normal",children:g?"Loading...":`${o.length} active session(s)`})]})]}),o.length>0&&e.jsxs(k,{variant:"outline",className:"text-xs",children:[o.filter(s=>s.isCurrent).length," current"]})]})}),e.jsx(M,{className:"space-y-4",children:g?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(S,{className:"w-6 h-6 animate-spin mr-2"}),e.jsx("span",{children:"Loading active sessions..."})]}):o.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(K,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No active sessions found"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(we,{children:o.map(s=>e.jsx(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded-lg border-2 transition-all duration-200 ${s.isCurrent?"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-800":"bg-muted/30 hover:bg-muted/50 border-border"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-background rounded-md",children:d(s.deviceInfo)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:s.deviceInfo||"Unknown Device"}),s.isCurrent&&e.jsx(k,{variant:"default",className:"text-xs px-2 py-0",children:"This Device"})]}),e.jsxs("div",{className:"space-y-1 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3 h-3"}),s.ipAddress]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"w-3 h-3"}),C(s.createdAt)]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"w-3 h-3"}),"Created:"," ",new Date(s.createdAt).toLocaleString()]})]})]})]}),!s.isCurrent&&e.jsx(u,{variant:"destructive",size:"sm",onClick:()=>w(s.id),disabled:N===s.id,className:"shrink-0",children:N===s.id?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-3 h-3 mr-1 animate-spin"}),"Ending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-3 h-3 mr-1"}),"End Session"]})})]})},s.id))}),o.length>1&&o.some(s=>!s.isCurrent)&&e.jsxs(v.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"pt-2",children:[e.jsx(X,{className:"mb-4"}),e.jsxs(V,{children:[e.jsx(B,{asChild:!0,children:e.jsx(u,{variant:"destructive",className:"w-full",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}),"Ending all sessions..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"End all other sessions (",o.filter(s=>!s.isCurrent).length,")"]})})}),e.jsxs(O,{children:[e.jsxs(U,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-red-500"}),"End All Other Sessions?"]}),e.jsx(Y,{children:"This will log you out from all other devices except this one. You'll need to log in again on those devices to access your account."})]}),e.jsxs(Z,{children:[e.jsx(G,{children:"Cancel"}),e.jsx(J,{onClick:l,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}),"Ending sessions..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"End All Other Sessions"]})})]})]})]})]})]})})]})]})}const oa=()=>{const[a,f]=h.useState(null),[r,x]=h.useState(!0),[o,t]=h.useState(!1),[g,n]=h.useState(0),c=ve();Ne();const j=le();h.useEffect(()=>{N()},[]);const N=async()=>{try{const l=await j.get("/user/get_user_data");f(l.data.user),n(l.data.currentStreak)}catch(l){console.error("Error fetching user data:",l),i.error("Failed to load profile data")}finally{x(!1)}},b=async l=>{t(!0);try{const d=await j.put("/user/update",l,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});R("Profile",{context:"Updated"}),f(d.data.user),i.success("Profile updated successfully!")}catch(d){throw console.error("Error updating profile:",d),i.error("Failed to update profile"),d}finally{t(!1)}},p=async l=>{t(!0);try{const d=await j.put("/auth/change-password",l);R("Profile",{context:"Password Changed"}),i.success("Password changed successfully!")}catch(d){throw console.error("Error changing password:",d),i.error(d.response.data.message||"Failed to change password"),d}finally{t(!1)}},w=async()=>{t(!0);try{await c(),window.location.href="/"}catch(l){console.error("Error logging out:",l),i.error("Failed to logout")}finally{t(!1)}};return r?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your profile..."})]})}):a?e.jsx("div",{className:"min-h-screen py-8",children:e.jsx("div",{className:"container mx-auto px-4 max-w-4xl",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(We,{user:a,onUpdateProfile:b,isUpdating:o}),e.jsx(Xe,{user:a,currentStreak:g}),e.jsx(Qe,{user:a,onLogout:w,onChangePassword:p,isUpdating:o})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to load profile data"}),e.jsx(u,{onClick:N,children:"Try Again"})]})})};export{oa as default};
